%!TEX root = interventions.tex
\section{Interventions}
\subsection{Definition}
\begin{frame}{Interventionen}
    \begin{block}{Interventionsverteilung}
        Sei $\mathbb{P}^\mathbf{X}$ die zu einer SEM
        $\mathcal{S} := (\mathcal{S}, \mathbb{P}^N)$ gehörende Verteilung. Dann
        kann eine (oder mehr) Strukturgleichungen aus $\mathcal{S}$ entfernt
        werden ohne einen Zyklus im Graphen zu erzeugen. Die Verteilung des
        neuen SEM $\tilde{\mathcal{S}}$ heißt dann
        \textit{Interventionsverteilung}.

        Bei den Variablen, deren Strukturgleichungen ersetzt wurden, sagt man,
        wurde \textit{interveniert}.

        Die neue Verteilung wird mit
        \[\mathbb{P}_{\tilde{\mathcal{S}}}^{\mathbf{X}} = \mathbb{P}_{\mathcal{S}}^{\mathbf{X}| do(X_j=\tilde{f}(\tilde{\mathbf{PA}}_j, \tilde{N}_j))}\]
        beschrieben.

        Die Menge der Rauschvariablen in $\mathcal{S}$ beinhaltet nun einige
        \enquote{neue} und einige \enquote{alte} $N$'s. $\mathcal{S}$ muss
        paarweise unabhängig sein.
    \end{block}
\end{frame}

% \begin{frame}{Interventionen: Spezialfälle}
%     \begin{block}{Interventionsverteilung}
%         Wenn $\tilde{f}(\tilde{\mathbf{PA}_j}, \tilde{N}_j)$ eine Punktmasse
%         auf ein $a \in \mathbb{R}$ legt schreibt man
%         \[\mathbb{P}_\mathcal{S}^{\mathbf{X}|do(X_j = \tilde{f}(\tilde{\mathbf{PA}_j}, \tilde{N}_j))}\]
%         und nennt die Intervention
%         \textbf{perfekt}.\\

%         Eine Intervention mit $\tilde{\mathbf{PA}_j} = \mathbf{PA}_j$ wird
%         \textbf{mangelhaft} genannt.
%     \end{block}
% \end{frame}

\begin{frame}[t]{Beispiel 2.2.2: Ursache und Effekt}
    Es sei $\mathcal{S}$ gegeben durch
    \begin{align}
        X &= N_X\\
        Y &= 4 \cdot X + N_Y
    \end{align}
    mit $N_X, N_Y \overset{\text{iid}}{\sim} \mathcal{N}(0, 1)$ und den
    Graphen $X \rightarrow Y$.
    \only<2-9>{
        Dann gilt:
        \begin{align}
            \mathbb{P}_\mathcal{S}^Y = \mathcal{N}(0, 4^2 + 1) &\onslide<3->{\neq \mathcal{N}(8, 1)} \onslide<4->{= \mathbb{P}_\mathcal{S}^{Y|do(X=2)}} \onslide<5->{= \mathbb{P}_\mathcal{S}^{Y|X=2}}\\
            &\onslide<6->{\neq \mathcal{N}(12, 1)} \onslide<7->{= \mathbb{P}_\mathcal{S}^{Y|do(X=3)}} \onslide<8->{= \mathbb{P}_\mathcal{S}^{Y|X=3}}
        \end{align}
        \onslide<9->{$\Rightarrow$ Intervention auf $X$ beeinflusst die Verteilung von $Y$.}
    }
    \only<10-13>{
        Aber:

        \begin{align}
            \mathbb{P}_\mathcal{S}^{X|do(Y=2)} &= \mathcal{N}(0, 1)\\
            \onslide<11->{&= \mathbb{P}_\mathcal{S}^X}\\
            \onslide<12->{&= \mathbb{P}_\mathcal{S}^{X|do(Y=3.14159)}}\\
            \onslide<13->{&\neq \mathbb{P}_\mathcal{S}^{X|Y=2}}
        \end{align}
    }
    \only<14->{\\
        Beispiel: $X$ (rauchen) $\rightarrow Y$ (weiße Zähne)
        \begin{itemize}
            \item<15-> Es besteht eine Asymmetrie zwischen Ursache ($X$) und Effekt ($Y$).
            \item<16-> $\mathbb{P}_\mathcal{S}^{X,Y|do(Y=\tilde{N}_Y)} \Rightarrow X \perp\!\!\!\perp Y$
            \item<17-> $\mathbb{P}_\mathcal{S}^{X,Y|do(X=\tilde{N}_X)} \text{ und } Var(\tilde{N}_X) > 0 \Rightarrow X \not\perp\!\!\!\perp Y$
        \end{itemize}
    }
\end{frame}

\section{Totaler kausaler Effekt}
\subsection{Totaler kausaler Effekt}
\begin{frame}{Totaler kausaler Effekt}
    \begin{block}{Totaler kausaler Effekt}
        Gegeben sei ein SEM $\mathcal{S}$. Dann gibt es einen
        (totalen) kausalen Effekt von $X$ nach $Y$ genau dann wenn
        \[\exists \tilde{N}_: X \not\!\perp\!\!\!\perp Y \text{ in } \mathbb{P}_\mathcal{S}^{\mathbf{X}|do(X=\tilde{N}_X)}\]
        gilt.
    \end{block}
\end{frame}

\begin{frame}[t]{Totaler kausaler Effekt: Äquivalenzen}
    Folgende Aussagen sind äquivalent:

    \begin{enumerate}[label=(\roman*)]
        \item $\exists \tilde{N}_X \hphantom{\text{ mit vollem Support }}: X \not\!\perp\!\!\!\perp Y \text{ in } \mathbb{P}_\mathcal{S}^{\mathbf{X}|do(X=\tilde{N}_X)}$
        \item $\exists x^\triangle \exists x^\square: \mathbb{P}_\mathcal{S}^{Y|do(X=x^\triangle)} \neq \mathbb{P}_\mathcal{S}^{Y|do(X=x^\square)}$
        \item $\exists x^\triangle \hphantom{\exists x^\square}: \mathbb{P}_\mathcal{S}^{Y|do(X=x^\triangle)} \neq \mathbb{P}_\mathcal{S}^Y$.
        \item $\forall \tilde{N}_X \text{ mit vollem Support }: X \not\!\perp\!\!\!\perp Y \text{ in } \mathbb{P}_\mathcal{S}^{\mathbf{X}|do(X=\tilde{N}_X)}$
    \end{enumerate}

    \only<2>{
    \textbf{Beweisplan:}\\
    (i) $\Rightarrow$ (ii) $\Rightarrow$ (iv) $\Rightarrow$ (i)\\
    $\neg$(i) $\Rightarrow$ $\neg$ (iii) äquivalent zu (iii) $\Rightarrow$ (i)\\
    (ii) $\Rightarrow$ (iii)
    }
    \only<3-5>{
        \textbf{Beweisplan:} (i) $\Rightarrow$ (ii)\\
        \onslide<4->{(i) $\overset{A.2}{\Rightarrow} \exists x_1^\triangle, x_1^\square$ mit
        pos. Dichte unter $\tilde{N_1}$ sodass $\mathbb{P}_\mathcal{S}^{X_2|X_1=x_1^\triangle, do(X_1=\tilde{N_1})} \neq \mathbb{P}_\mathcal{S}^{X_2 | X_1=x^\square, do(X_1=\tilde{N_1})}$\\}
        \onslide<5->{$\overset{A.1}{\Rightarrow} (ii)$}
    }
    \only<6>{
        \textbf{Beweisplan:} (ii) $\Rightarrow$ (iv)\\
        \onslide<7->{(ii) $\overset{A.1}{\Rightarrow} \exists x_1^\triangle, x_1^\square$ mit pos. Dichte unter $\hat{N_1}$ sodass $\mathcal{P}_\mathcal{S}^{X_2|X_1=x_1^\triangle, do(X_1=\hat{N_1})} \neq \mathbb{P}_\mathcal{S}^{X_2 | X_1 = x_1^\square, do(X_1 = \hat{N_1})}$}
        \onslide<8->{$\overset{A.2}{\Rightarrow} (iv)$}
    }
    \only<9>{
        \textbf{Beweisplan:} (iv) $\Rightarrow$ (i)\\
        Trivial
    }
    \only<10>{
        \textbf{Beweisplan:} $\neg$(i) $\Rightarrow$ $\neg$ (iii)\\
        \onslide<11->{Es gilt: $\mathbb{P}_\mathcal{S}^{X_2} = \mathbb{P}_\mathcal{S}^{X_2 | do(X_1 = N_1^*)}$, wobei $N_1^*$ wie $\mathbb{P}_\mathcal{S}^{X_2}$ verteilt ist.}
    }
    \only<11>{
        \textbf{Beweisplan:} (ii) $\Rightarrow$ (iii)\\
        Trivial (TODO: wirklich?)
    }
\end{frame}

\begin{frame}{Beispiel 2.2.6: Randomisierte Studie}
    \begin{itemize}
        \item<1-> Weise eine Behandlung $T$ zufällig (nach $\tilde{N_T}$) einem
              Patienten zu. Das könnte auch ein Placebo sein.
        \item<2-> Im SEM: Daten aus $\mathbb{P}_\mathcal{S}^{\mathbf{X}|do(T=\tilde{N_T})}$
        \item<3-> Falls immer noch Abhängigkeit zw. Behandlung und Erfolg
              vorliegt $\Rightarrow T$ hat einen totalen kausalen Effekt auf
              den Behandlungserfolg.
    \end{itemize}
\end{frame}

\begin{frame}{Beispiel 2.2.7: Nicolai's running-and-health Beispiel}
    Das zugrundeliegende (\enquote{wahre}) SEM $\mathcal{S}$, welches die Daten
    generierte, hat die Form:

    \begin{align}
        A &= N_A            &&\text{mit } N_A \sim Ber(\nicefrac{1}{2})\\
        H &= A + N_H \mod 2 &&\text{mit } N_H \sim Ber(\nicefrac{1}{3})\\
        B &= H + N_B \mod 2 &&\text{mit } N_B \sim Ber(\nicefrac{1}{20})
    \end{align}

    mit dem Graphen $A \rightarrow H \rightarrow B$ und\\
    $N_A, N_H, N_B$ unabhängig.

    \begin{itemize}
        \item<1->  $B$ ist hilfreicher für die Vorhersage von $H$ als $A$.
        \item<2->  Intervention von $A$ hat auf $H$ einen größeren Einfluss als Intervention von $B$.
    \end{itemize}
\end{frame}

\begin{frame}{Proposition 2.2.9}
    \begin{enumerate}[label=(\roman*)]
        \item<1-> Falls es keinen gerichteten Pfad von $X$ nach $Y$ gibt, dann
                  gibt es keinen kausalen Effekt.
        \item<2-> Manchmal gibt es einen gerichteten Pfad, aber keinen kausalen
                  Effekt.
    \end{enumerate}

    \onslide<3->{Beweis von (i): Folgt aus der Markov-Eigenschaft des
                 interventierten SEMs. }\onslide<4->{Nach dem Entfernen der
                 in $X$ eingehenden Kanten gilt: $X$ und $Y$ sind
                 $d$-separiert, falls es keinen direkten Pfad von $X$ nach
                 $Y$ gibt. \\}
    \onslide<5->{Beweis von (ii) durch Gegenbeispiel: Sei
    \begin{align}
        X &= N_X\\
        Z &= 2X + N_Z\\
        Y &= 4X - 2Z + N_Y
    \end{align}
    Dann gilt: $Y = - 2N_Z + N_Y$ und daher $X \perp\!\!\!\perp$ für alle $N_X$. $\square$
    }
\end{frame}

% \begin{frame}{Nierensteine}
% \begin{columns}
%     \begin{column}{0.45\textwidth}
%         \begin{center}\textbf{Modell A}\end{center}
%     \end{column}
%     \begin{column}{0.45\textwidth}
%         \begin{center}\textbf{Modell B}\end{center}
%     \end{column}
% \end{columns}
% \end{frame}